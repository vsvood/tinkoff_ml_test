# TINKOFF_ML_TEST или "ты похорошел и возмужал продолжала графиня взяв дочь за руку дернул к себе отогреть французского офицера оторвана так быстро что бежавшая за нею дверь."

## Тестовое задание для курса ML от Тинькофф 
P.s. Избранные отрывки в конце файла)
### Обучение
train.py
Данный файл ответственен за обучение модели на текстовых файлах. Использование
описано ниже.
```shell
usage: train.py [-h] [--input-dir <path>] --model <path>

options:
  -h, --help            show this help message and exit
  --input-dir <path>, -i <path>
                        Path to data dir. Data should be stored as normal text files
  --model <path>, -m <path>
                        Path to file where to save model
```
Если опция --input-dir опущена, то считывание происходит из терминала

Пример:
```shell
python train.py --input-dir=data/big_dataset --model=model.pkl
```
Файл обучает модель триграм на всех текстах из указанной директории. В качестве токенов выбираются все слова, приведённые к lower case и точки. После введения последнего правила связность текстов увеличилась.

Пример обученной командой из примера модели model.pkl лежит в корневой директории. Модель сохранена в версии питона 3.10.5. 

### Предупреждение! Запуск с данной моделью кушает вплоть до 12Гб оперативной памяти.
Модель обученная только на Войне и Мире доступна в репозитории по тэгу v_1.0

### Генерация
За генерацию ответственен файл generate.py. Использование:
```shell
usage: generate.py [-h] --model <path> [--prefix <str>] --length <int>

options:
  -h, --help            show this help message and exit
  --model <path>, -m <path>
                        Path where to load model from
  --prefix <str>, -p <str>
                        Prefix for generated phrase
  --length <int>, -l <int>
                        Length of generated phrase
```
Если префикс опущен, он считается пустым

Пример
```shell
pyhton generated.py --model=model.pkl --length=100
```
Текст из заголовка и представленные ниже перлы являются избранными отрывками из текстов, сгенерированных этой командой.


### Несколько перлов:
#### Война и мир(все тома, точка считается токеном)

на крыльце не переставая бормотал что то глазами .

ростов не желая воспользоваться его лаской и устроить себе выдачу единовременного пособия или он удаляется чего одного мы должны изменить совершенно предмет наблюдения тем сомнительнее становится свобода людей производивших события и тем ударом который он придумал лучше облиться в сарае крестьянскои избы сидящего на бочонке и занятого письменными работами он поверял счеты .

адъютант исполнив приказание подходил к сараю в самом себе .

хлеб до ста человек гостей на один день наш государь дает отзыв а другой короткий обрезанный чубук закладывая привычным жестом наперед курчавя свои черные волосы на висках поглядывал то на одного француза и обманывая себя находил причины самодовольства в том чтобы драться с французами то чтобы бог простил помер .

#### Предложения от продвинутой модели(90 томов Толстого, 4-граммы)

сохраняя вашу теперешнюю веру вы чувствуете что любили меня с эгоизмом .

так прошел тихо и грустно отвѣчалъ извините меня графиня но это не помогло ему .

какъ мнѣ тоже почему то зналъ что нынче вечеромъ ар кадій придя въ свою коморку вписалъ въ своемъ дневникѣ иногда хочется по дѣтски кому то богу жаловаться просить помощи .

из всех сил дергал за перекладины рама не подавалась . если рама выйдет теперь сразу когда я потяну с ним подумал князь василий 922 придвигая кресло к столу даже милее чем прежде и до и после евангелия начиная с моисея исаии конфуция древних греков будды сократа и до христа магомета и всех других нижеперечисленных 4 .

с кем схож с тем и потребность дружбы заботы симпатии потребность свидетельствовавшая о любви к путешествиям

и все таки честное и достойное лицо левину казалось что он презрительно улыбается на мои слова и опровергает его содержание .

в письме на немецком языке от 25 ноября 1906 . печатается по неполной рукописной копии этого письма толстого а его ответ видимо лично свезла в ясную поляну 1 сентября .

17 августа . всталъ поздно игралъ . гимнастика ноги болятъ . гальперинъ съ женой .

онъ не убѣдится онъ будет думать они всѣ будутъ торжествовать они всѣ скажутъ вотъ она хотѣла быть всегда лучше въ смыслѣ доброты .

в ту же ночь пустил кровь и объявил что он не юрист сперанский говорил что никто не любит меня .

на днях был у нас в старогладковской и живет со мной на твоей квартире которой архитектурой он очень недоволен .

ах еслиб я был свободен в своих поступках не соображениями о последствиях внешних поступков а только той самой крайне опасной функцией мозга которая всегда всеми разумными и мудрыми людьми мира называлась духовным началом жизни и проявлялась и проявляется любовью для того чтобы никто не мог добиться .